

## 子网
		早期的ARPAnet，IP构成为二级，也就是IP组成为 【网络号】【主机号】，这种组成方法其实并不合理，例如在A类和B类地址里，依旧有相当多主机数量要找，最后一跳的路由，交付数据包到主机时，要查询相当长的一段时间。于是，1985年后，IP地址又增加了一个子网号，IP的组成由2级IP变成了3级IP。
		三级的IP构成为【网络号】【子网号】【主机号】
		因此，最后一跳的路由，可以通过子网掩码，缩小查找主机的范围。
		例如145.13.0.0下的子网划分为：

![[Pasted image 20230224114404.png]]

		查找主机的过程，从 找到路由R1，R1查表找到主机，变成 找到路由R1，R1通过子网掩码缩小查找范围，找到主机。这样子就大大的缩减了查表的时间。但路由表需要多维护一份子网掩码的数据.

路由表的链接过程将会变成如下模样：
![[Pasted image 20230224115125.png]]

		这个查找的过程如下：
		1、主机H1的IP为128.30.33.13，他的子网网络地址为128.30.33.0，掩码255.255.255.128；
		2、H1要查找主机H2，他的IP为182.30.33.138；
		3、首先，要判断H2是否和H1在同一个子网下；
		4、使用H2的IP，和H1的子网掩码进行与运算，得到128.30.33.128；
		5、得到的结果不是H1所在子网的网络地址，说明H2和H1不在一个子网；
		6、H1将数据包交付路由器R1;
		7、R1依据路由表的子网掩码运算；
		8、首先运算的是掩码255.255.255.128，与H2IP运算，得到结果非128.30.33.0；
		9、然后运算的是掩码255.255.255.128，结果是128.30.33.128，确定下一跳为接口1；
		10、数据包跳入子网2，交付目标主机H2;


## VLSM
		VLSM,变长子网掩码，可以理解他为子网再划分子网。
		比如一个中小型的公司，它3个部分分别需要100，50，25个IP地址。
		如果按照之前的子网划分，那么，假如公司申请一个C类地址192.168.12.0-192.168.12.255，那么，接下来将他这个C类地址划分子网。
		
		方案1、为了让部门1获得100个IP，设计子网掩码为255.255.255.128，
		如此，则划分出2个子网，分别是：
		子网A:192.168.12.0-192.168.12.127
		子网B:192.168.12.128-192.168.12.255
		这样子，部门1部门2都获得128个地址，部门3没有地址，不合理。

		方案2、按照64个地址为一个子网划分，设计掩码255.255.255.064，255.255.128
		如此，划分出3个子网，分别是：
		子网A:0-63;
		子网B:64-127;
		子网C:128-255;
		结果，部门1IP不够，部门3IP多余。
	
		如果设计更多的子网掩码，路由表的大小又会倍增，不够划算。因此，VLSM诞生了，它按照变长子网掩码，对以划分的子网继续划分。
		它是这样划分的 IP地址为32位，它将IP地址分为两个部分，【网络前缀】【主机号】
		例如上述公司的划分两个128大小子网，这样标识
		1、192.168.12.0/24
		2、/24表示，32位IP地址前24都都是前缀，只有后8位划分子网，那么分界线就是2的8次方 256
		3、也就是公司获得 192.168.12.0往后的256个地址 到192.168.12.255
		4、然后 给部门1设计子网掩码192.168.12.0/25
		5、这表示从192.168.12.0往后128个地址属于部门1 到192.168.12.127
		6、接着，划分部门2掩码 192.168.12.128/26
		7、那么部门2获得192.168.12.128-192.168.12.191，共64个IP
		8、再来给部门3划分子网掩码
		9、······
		通过这种掩码的方式，让子网下的子网套娃划分，使得IP得到更合理得分配。

---
# CIDR
>CIDR就是再VLSM的基础上发展起来的。
>但CIDR,允许跨网分配，使得两个甚至多个C类地址合成一个子网，成为超网。
>比如：

		192.14.32.0/20！
		它往后2的12次方个地址远远超出256个C类该有的长度，地址到达了192.14.47.255。
		因此，一共有15个C类地址被合并成一个子网，这样的合并称为超网。如此，A类，B类,C类地址的界限变得模糊，地址分配的粒度也变细了。不在因为一个公司1000人，申请一个C类不够，申请一个B类太多的情况。它可以直接申请 IP起始地址\10,共1024个地址，不再收到A,B,C类的限制。
		如此划分新的分类，就没有了A,B,C类，变成了如下规定:
|前缀	|特殊用途|
|:---:|:---:|
|0.0.0.0/8|	在本网络上的本主机。仅作为源IP地址使用|
|10.0.0.0/8	|专用内网地址。该地址块不会出现在因特网中|
|127.0.0.0/8	|回环地址，一般用127.0.0.1作为本地回环地址|
|169.254.0.0/16	|“链路本地“地址，只用于一条链路，通常自动分配|
|172.16.0.0/12	|专用内网地址。该地址块不会出现在因特网中|
|192.0.0.0/24	|IETF协议分配(IANA保留)|
|192.0.2.0/24|	批准用于文档中的TEST-NET-1地址。这种地址不会出现在公共Intemet中|
|192.88.99.0/24	|用于6to4中继(任播地址)|
|192.168.0.0/16|	专用内网地址。该地址块不会出现在因特网中|
|198.18.0.0/15|	用于基准和性能测试|
|198.51.100.0/24	|TEST-NET-2地址。被批准用于文档中|
|203.0.113.0/24	|TEST-NET-3地址。被批准用于文档中|
|224.0.0.0/4	|以前的D类地址，也就是组播地址，仅作为目的地址使用|
|240.0.0.0/4|	要除开255.255.255.255，以前的E类地址，保留空间地址|
|255.255.255.255/32|	本地网络的广播地址|


